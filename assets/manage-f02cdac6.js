import{j as D,C as g,k as I,d as v,o as u,c as p,a as b,e,L as V,b as t,w as _,l as m,m as N,i as w,p as S,f as $,_ as x,n as L,q as T,g as F,F as M,r as U,t as f,s as P,h as E}from"./index-b82181c4.js";import{u as O}from"./loginStore-8ea8c262.js";const k=D("ManageStore",{state:()=>({products:[],pagination:{},tempProduct:{},isNew:!1,isLoading:!1,status:{fileUploading:!1},uploadedFile:null,uploadLoading:!1}),getters:{},actions:{async getProducts(l=1){this.isLoading=!0,await g("GET",`https://vue-course-api.hexschool.io/api/lucy104/admin/products?page=${l}`,"").then(s=>{console.log("取得產品"),console.log(s.data),s.data.success&&(this.isLoading=!1,this.products=s.data.products,this.pagination=s.data.pagination)})},switchData(l,s){l?(this.tempProduct={},this.isNew=!0):(console.log(s),this.tempProduct=Object.assign({},s),this.isNew=!1)},async addProducts(){this.isLoading=!0;const l={data:this.tempProduct};await g("POST","https://vue-course-api.hexschool.io/api/lucy104/admin/product",l).then(s=>{console.log("建立產品"),console.log(s.data),s.data.success&&(this.isLoading=!1,this.tempProduct={},this.getProducts())})},async updateProducts(){this.isLoading=!0;const l={data:this.tempProduct};await g("PUT",`https://vue-course-api.hexschool.io/api/lucy104/admin/product/${this.tempProduct.id}`,l).then(s=>{console.log("更新產品"),console.log(s.data),s.data.success&&(this.isLoading=!1,this.getProducts())})},switchDeleteData(l){this.tempProduct=Object.assign({},l)},async deleteProducts(){this.isLoading=!0,await g("DELETE",`https://vue-course-api.hexschool.io/api/lucy104/admin/product/${this.tempProduct.id}`,"").then(l=>{console.log("刪除產品"),console.log(l.data),l.data.success&&(this.isLoading=!1,this.getProducts())})},async uploadFile(l){var i;this.uploadLoading=!0;const s=(i=l.target.files)==null?void 0:i[0];if(s){const d=new FormData;d.append("file-to-upload",s);const c=I.create();c.defaults.headers["Content-Type"]="multipart/form-data";try{const r=await g("POST","https://vue-course-api.hexschool.io/api/lucy104/admin/upload",d);console.log("上傳圖片"),console.log(r.data),r.data.success&&(this.uploadLoading=!1,this.tempProduct.imageUrl=r.data.imageUrl)}catch(r){console.error(r)}finally{delete c.defaults.headers["Content-Type"]}}}}}),n=l=>(S("data-v-ca13da28"),l=l(),$(),l),j={class:"modal fade",id:"productModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},q={class:"modal-dialog"},B={class:"modal-content"},H=n(()=>t("div",{class:"modal-header"},[t("span",{class:"text-white fs-20"},"建立新產品"),t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),z={class:"modal-body"},A={class:"row"},G={class:"col-md-4"},J=n(()=>t("label",{class:"fs-16"},"輸入圖片網址",-1)),K=n(()=>t("label",{class:"fs-16 mt-20"},"或上傳圖片",-1)),Q=["src"],R={class:"col-md-8"},W={class:"row"},X={class:"col-md-12"},Y=n(()=>t("label",{class:"fs-16"},"標題",-1)),Z={class:"col-md-6 col-6 mt-20"},tt=n(()=>t("label",{class:"fs-16"},"分類",-1)),st={class:"col-md-6 col-6 mt-20"},et=n(()=>t("label",{class:"fs-16"},"單位",-1)),ot={class:"col-md-6 col-6 mt-20"},at=n(()=>t("label",{class:"fs-16"},"原價",-1)),lt={class:"col-md-6 col-6 mt-20"},it=n(()=>t("label",{class:"fs-16"},"售價",-1)),dt={class:"col-md-12 mt-20"},nt=n(()=>t("label",{class:"fs-16"},"產品描述",-1)),ct={class:"col-md-12 mt-20"},rt=n(()=>t("label",{class:"fs-16"},"說明內容",-1)),ut={class:"form-check"},pt=n(()=>t("label",{class:"form-check-label",for:"flexCheckDefault"}," 是否啟用 ",-1)),_t={class:"modal-footer"},mt=n(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1)),ht=v({__name:"productModal",setup(l){const s=k(),{uploadFile:i,addProducts:d,updateProducts:c}=s;return(r,a)=>(u(),p("div",null,[b(e(V),{active:e(s).uploadLoading,"onUpdate:active":a[0]||(a[0]=o=>e(s).uploadLoading=o),"can-cancel":!0,"is-full-page":!0},null,8,["active"]),t("div",j,[t("div",q,[t("div",B,[H,t("div",z,[t("form",null,[t("div",A,[t("div",G,[J,_(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":a[1]||(a[1]=o=>e(s).tempProduct.imageUrl=o)},null,512),[[m,e(s).tempProduct.imageUrl]]),K,t("input",{type:"file",class:"form-control",onChange:a[2]||(a[2]=(...o)=>e(i)&&e(i)(...o))},null,32),t("img",{src:e(s).tempProduct.imageUrl,alt:"",class:"mt-20"},null,8,Q)]),t("div",R,[t("div",W,[t("div",X,[Y,_(t("input",{type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":a[3]||(a[3]=o=>e(s).tempProduct.title=o)},null,512),[[m,e(s).tempProduct.title]])]),t("div",Z,[tt,_(t("input",{type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":a[4]||(a[4]=o=>e(s).tempProduct.category=o)},null,512),[[m,e(s).tempProduct.category]])]),t("div",st,[et,_(t("input",{type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":a[5]||(a[5]=o=>e(s).tempProduct.unit=o)},null,512),[[m,e(s).tempProduct.unit]])]),t("div",ot,[at,_(t("input",{type:"number",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":a[6]||(a[6]=o=>e(s).tempProduct.origin_price=o)},null,512),[[m,e(s).tempProduct.origin_price]])]),t("div",lt,[it,_(t("input",{type:"number",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":a[7]||(a[7]=o=>e(s).tempProduct.price=o)},null,512),[[m,e(s).tempProduct.price]])]),t("div",dt,[nt,_(t("textarea",{class:"form-control",rows:"3","onUpdate:modelValue":a[8]||(a[8]=o=>e(s).tempProduct.description=o)},null,512),[[m,e(s).tempProduct.description]])]),t("div",ct,[rt,_(t("textarea",{class:"form-control",rows:"3","onUpdate:modelValue":a[9]||(a[9]=o=>e(s).tempProduct.content=o)},null,512),[[m,e(s).tempProduct.content]]),t("div",ut,[_(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":a[10]||(a[10]=o=>e(s).tempProduct.is_enabled=o),"true-value":1,"false-value":0,id:"flexCheckDefault"},null,512),[[N,e(s).tempProduct.is_enabled]]),pt])])])])])])]),t("div",_t,[mt,e(s).isNew==!1?(u(),p("button",{key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:a[11]||(a[11]=(...o)=>e(c)&&e(c)(...o))},"更新")):w("",!0),e(s).isNew?(u(),p("button",{key:1,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:a[12]||(a[12]=(...o)=>e(d)&&e(d)(...o))},"確認")):w("",!0)])])])])]))}});const gt=x(ht,[["__scopeId","data-v-ca13da28"]]),ft=D("CssStore",{state:()=>({navSlide:!1,switchSlide:!1,allSlide:!1}),getters:{},actions:{SlideControl(l){setTimeout(()=>{l=="switchToggle"?(this.switchSlide=!this.switchSlide,this.navSlide=!1,this.allSlide=!0):l=="navToggle"?(this.navSlide=!this.navSlide,this.switchSlide=!1,this.allSlide=!0):(this.switchSlide=!1,this.navSlide=!1,this.allSlide=!1)},1)},hideFilter(){this.switchSlide=!1,this.navSlide=!1,this.allSlide=!1}}}),bt=l=>(S("data-v-c566fe18"),l=l(),$(),l),vt=bt(()=>t("span",{class:"text-white fs-16",style:{"font-weight":"bold"}},"管理者系統",-1)),yt=v({__name:"manageHeader",setup(l){const s=O(),i=ft(),{logoutSubmit:d}=s,{SlideControl:c,hideFilter:r}=i;L("");let a=sessionStorage.getItem("loginInfo");return L(""),a!=null&&JSON.parse(a),(o,h)=>(u(),p("div",null,[t("nav",null,[vt,t("button",{type:"button",class:"btn btn-secondary",onClick:h[0]||(h[0]=(...C)=>e(d)&&e(d)(...C))},"登出")]),e(i).allSlide?(u(),p("div",{key:0,class:"outside",onClick:h[1]||(h[1]=C=>e(r)())})):w("",!0)]))}});const Pt=x(yt,[["__scopeId","data-v-c566fe18"]]),wt={class:"modal fade",id:"deleteModal",tabindex:"-1","aria-labelledby":"deleteModalLabel","aria-hidden":"true"},St={class:"modal-dialog"},$t={class:"modal-content"},xt=T('<div class="modal-header bg-danger"><h1 class="modal-title fs-5 text-white" id="deleteModalLabel">刪除產品</h1><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><p class="fs-16">是否刪除 商品(刪除後將無法恢復)。</p></div>',2),kt={class:"modal-footer"},Ct=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1),Lt=v({__name:"deleteModal",setup(l){const s=k(),{deleteProducts:i}=s;return(d,c)=>(u(),p("div",null,[t("div",wt,[t("div",St,[t("div",$t,[xt,t("div",kt,[Ct,t("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:c[0]||(c[0]=(...r)=>e(i)&&e(i)(...r))},"刪除產品")])])])])]))}}),y=l=>(S("data-v-facf8285"),l=l(),$(),l),Mt={class:"container-fluid allSpace"},Ut={class:"row"},Dt=y(()=>t("p",{class:"text-center fs-25"},"產品列表",-1)),Vt={class:"col-md-12"},It={class:"col-md-12 mt-40"},Nt={class:"table table-hover"},Tt=y(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},"分類"),t("th",{scope:"col"},"產品名稱"),t("th",{scope:"col"},"原價"),t("th",{scope:"col"},"售價"),t("th",{scope:"col"},"編輯"),t("th",{scope:"col"},"刪除")])],-1)),Ft=["onClick"],Et=["onClick"],Ot={class:"col-md-12"},jt={"aria-label":"Page navigation example"},qt={class:"pagination"},Bt={class:"page-item"},Ht=y(()=>t("span",{"aria-hidden":"true"},"«",-1)),zt=[Ht],At=["onClick"],Gt={class:"page-item"},Jt=y(()=>t("span",{"aria-hidden":"true"},"»",-1)),Kt=[Jt],Qt=v({__name:"manage",setup(l){const s=k(),{getProducts:i,switchData:d,switchDeleteData:c}=s;return F(i),(r,a)=>(u(),p("div",null,[b(Pt),b(gt),b(Lt),t("div",Mt,[t("div",Ut,[Dt,t("div",Vt,[t("button",{type:"button",class:"btn btn-primary",style:{float:"right"},onClick:a[0]||(a[0]=o=>e(d)(!0,{})),"data-bs-toggle":"modal","data-bs-target":"#productModal"},"建立新的產品")]),t("div",It,[t("table",Nt,[Tt,t("tbody",null,[b(e(V),{active:e(s).isLoading,"onUpdate:active":a[1]||(a[1]=o=>e(s).isLoading=o),"can-cancel":!0,"is-full-page":!0},null,8,["active"]),(u(!0),p(M,null,U(e(s).products,o=>(u(),p("tr",null,[t("td",null,f(o.category),1),t("td",null,f(o.title),1),t("td",null,f(o.origin_price),1),t("td",null,f(o.price),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:h=>e(d)(!1,o),"data-bs-toggle":"modal","data-bs-target":"#productModal"},"編輯",8,Ft)]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger",onClick:h=>e(c)(o),"data-bs-toggle":"modal","data-bs-target":"#deleteModal"},"刪除",8,Et)])]))),256))])])]),t("div",Ot,[t("nav",jt,[t("ul",qt,[t("li",Bt,[t("a",{class:P(["page-link",{disabled:!e(s).pagination.has_pre}]),href:"#","aria-label":"Previous"},zt,2)]),(u(!0),p(M,null,U(e(s).pagination.total_pages,o=>(u(),p("li",{class:P(["page-item",{active:e(s).pagination.current_page===o}]),key:o},[t("a",{class:"page-link",href:"#",onClick:E(h=>e(i)(o),["prevent"])},f(o),9,At)],2))),128)),t("li",Gt,[t("a",{class:P(["page-link",{disabled:!e(s).pagination.has_next}]),href:"#","aria-label":"Next"},Kt,2)])])])])])])]))}});const Xt=x(Qt,[["__scopeId","data-v-facf8285"]]);export{Xt as default};
